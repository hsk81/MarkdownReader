# Markdown Reader

<!-- ====================================================================== -->

## <!-- Empty H2 -->

A versatile documentation and presentation dizmo based on the [Markdown][1] notation.

<!-- ---------------------------------------------------------------------- -->

### Introduction

`MarkdownReader` is a dizmo which allows you to display content which has been written using the [Markdown][1] (MD) notation. On the left hand side you see the content and on the right hand side the table of contents (TOC) panel, where the latter can be toggled on and off.

This documentation itself is a rendered HTML which has been generated by an MD source: In this sense the `MarkdownReader` is a self documenting dizmo.

Once content in MD is written, and rendered as HTML it needs to be styled using CSS. The `MarkdownReader` provides a small set of pre-defined styles, which can be optionally overwritten based on your needs.

There are two main possibilities to provide your *own* MD content and CSS styles: Either (a) provide the URLs where the dizmo can fetch the necessary information from or (b) create a new dizmo and embed the `MarkdownReader` source code using so called [GIT submodules][2].

Option (a) is the easier approach, but option (b) offers a broader range of possibilities to customize your own `MarkdownReader` based dizmo: E.g. you can provide the dizmo with icons and its own title for re-branding purposes, or you can directly embed *assets* (like configuration, content, styles and images) to eliminate network dependency.

<!-- ---------------------------------------------------------------------- -->

### Overview

|   | Subject | File(s) or remarks |
|---|---------|--------------------|
| 1 | Settings | assets/settings.json |
| 2 | Markdown content | assets/md/${LANGUAGE}/index.md |
| 3 | CSS styling | assets/css/reader.css |
| 4 | Paging | next and previous page buttons |
| 5 | JavaScript hooks | assets/js/hooks.js |
| 6 | Markdown headers | H1 and H2 peculiarities |
| 7 | TOC panel | hiding of empty headers |
| 8 | Scrolling | content and TOC scroll bars |
| 9 | Back side | URLs and integrated CSS editor |

---

**Settings.json:**

By editing the `assets/settings.json` configuration file the `MarkdownReader` dizmo can be customized.

**Markdown content:**

Allows to express content using the MD notation: It needs to be provided either via an absolute URL or a relative path which can contain the `${LANGUAGE}` variable for translation purposes.

**CSS styling:**

Allows to style the HTML which is produced based on the MD content: It needs to be provided either via an absolute URL or a relative path.

**Paging:**

The `MarkdownReader` dizmo supports paging: By embedding a `#pager` HTML at the end of the MD source, content beneath headers of level *H3* are split and displayed as separate pages. Further, the next and previous buttons are also displayed then.

**Markdown headers:**

If paging is on, then the content *immediately* beneath H1 (or H2) headers is static, i.e. it is always displayed on every H2 (or H3) sub-pages under that heading.

**JavaScript hooks:**

If paging is on, it is possible to wire JavaScript hooks on a page turn: For this to work an `assets/js/hooks.js` script needs to be included. This feature allows to implement interactive content.

**TOC panel:**

The table of contents (TOC) panel on the right hand side can be toggled off and on using the dizmo menu. Further, it is possible to disable the TOC panel completely via a corresponding flag in the `assets/settings.json` file.

**Scrolling:**
 
The content and TOC panels support a scrolling mechanism, where the scroll bar for the content panel is hidden by default, but for the TOC panel it is shown by default .

**Back side:**

The back side of the `MarkdownReader` dizmo provides two fields to enter the MD and CSS URLs and an embedded CSS editor. Flipping to the back side is enabled by default, but if desired it can be disabled.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

By editing the `assets/settings.json` file the dizmo can be customized.

<!-- ---------------------------------------------------------------------- -->

### Settings.json

This is the configuration file where almost every aspect of the `MarkdownReader` dizmo can be customized. It is written using the JSON notation with an important exception: multi-line comments like `/*..*/` are supported!

Various aspects of the dizmo and how they can be influenced by these settings are explained in the remainder of this documentation. In addition, the file itself contains the aforementioned comments to provide another form of compact help.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

Allows to express content using the MD notation: It needs to be provided either via an absolute URL or a relative path.

<!-- ---------------------------------------------------------------------- -->

### Markdown content

The [Markdown][1] content source is defined in the `settings.json` configuration file via the `urlMd` key: By setting its value to `assets/md/${LANGUAGE}/index.md` the content should be fetched upon the start of the dizmo from a path relative to its root.

The `${LANGUAGE}` variable &ndash; if present &ndash; is dynamically replaced with a two character abbreviation of the current language of dizmoSpace, like *en* for English and accordingly for other languages.

Further, the value for `urlMd` is not necessarily required to represent a (local) relative path, but it can be any general URL as long as it is understood by the `jQuery.get` invocation to fetch the corresponding content.

Any *relative* Markdown image (or link) URL is interpreted relative to the base of `urlMd`; any *absolute* URL starting with `protocol://` (e.g. `http://`, `https://` or `file://`) is used as it is.

Finally, any URL starting with a *slash* `/` is relative to the dizmo base: This allows to fetch assets which have been embedded within the dizmo itself; e.g. to reference the embedded `md-logo.svg` image use:

    /bundles/com.dizmo.markdownreader/assets/img/md-logo.svg

**Info:** Any HTML snippet (or CSS style) can be mixed freely with the MD content. But this should be avoided as far as possible and only the native MD notation should be used &ndash; however, the `MarkdownReader` dizmo itself uses a limited number of such snippets like for the `#pager` buttons or the `hooks.js` script.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

Allows to style HTML which is produced based on the MD content: It needs to be provided either via an absolute URL or a relative path.

<!-- ---------------------------------------------------------------------- -->

### CSS styling

By setting the `urlCss` key to `assets/css/reader.css` a custom style can be applied to the MD content. Like for the `urlMd` key it is possible to set it to any URL to fetch the CSS from. The `reader.css` itself imports `assets/css/reader-base.css` which contains some basic style definitions. In general the latter CSS should always be imported.

The following HTML identifiers or classes can be used to style various aspects of the `MarkdownReader` dizmo: `#content`, `#md-toc`, `#md-toc-home`, `.md-toc-item`, `.md-toc-h1` ... `.md-toc-h5`, `#pager`, `#pager-lhs` and `#pager-rhs`.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

By embedding a `#pager` HTML, content beneath headers of level *H3* are split and displayed as separate pages.

<!-- ---------------------------------------------------------------------- -->

### Paging

The `MarkdownReader` dizmo supports paging: it can be enabled by embedding the following HTML snippet at the end of an MD content:

```
<div id="pager">
  <span id="pager-rhs" rel="next"></span>
  <span id="pager-lhs" rel="prev"></span>
</div>
```

If paging is required, but the pagers themselves not, then they can be hidden via an embedded CSS:

```
<div id="pager" style="display: none !important">
  <span id="pager-rhs" rel="next"></span>
  <span id="pager-lhs" rel="prev"></span>
</div>
```

Once paging is activated, the pages are split above the *H3* headers! This can be confusing at the start, and one needs to organize the MD content accordingly.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

Content placed immediately beneath H1 (or H2) headers is static, i.e. it is always displayed on every H2 (or H3) sub-pages under that heading.

<!-- ---------------------------------------------------------------------- -->

### Markdown headers

For example, to display the *same* video (or image) across multiple pages i.e. H3 headers, it needs to be placed in the MD content between the H2 and its first H3 sub-header (if any).
 
Similarly content between H1 and its first H2 sub-header (if any) is displayed across *all* pages. This mechanism is only active when paging is on.

Given the combined effects of paging w.r.t. H3 headers and static content between H2 and H3 headers (or H1 and H2), it is in general recommended to leave the H2 header titles empty.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

By including the `assets/js/hooks.js` script at the end of an MD content, the latter can be made interactive.

<!-- ---------------------------------------------------------------------- -->

### JavaScript hooks

When paging is on, the `MarkdownReader` dizmo triggers `turn:before` and `turn.after` events when a pages is turned to. The following snippets show how they can be subscribed to:

```
jQuery('#pager').on('
    turn:before', function (event, new_page, page) {
        // ..
    }
);
```

and:

```
jQuery('#pager').on('
    turn:after', function (event, new_page, page) {
        // ..
    }
);
```

For example, the overlay displayed when the `MarkdownReader` dizmo starts has been implemented using a subscription to the `turn:before` event.

At the start (or when the `#md-toc-home` button is clicked) the `page` parameter is not defined, otherwise it contains the index of the current page.

It is also possible to define more advanced hooks by overwriting the following functions with:

```
MarkdownReader.my.lhsPageTo = function (page, pages, go) {
    // ..
}
```

and:

```
MarkdownReader.my.rhsPageTo = function (page, pages, go) {
    // ..
}
```

These two function essentially allow to block paging till a custom condition is met. They are independent from the previous two and both sets of functions can be used in parallel.

See also `assets/js/hooks.js` for further details. 

<!-- ====================================================================== -->

## <!-- Empty H2 -->

The table of contents (TOC) panel on the right hand side can be toggled off and
on using the dizmo menu.

<!-- ---------------------------------------------------------------------- -->

### TOC panel

The `tocFlag` in the  `assets/settings.json` configuration file can be set to `true`, `false` or `null`. With `true` the TOC is enabled and also initially displayed; with `false` it is also *enabled*, but it is hidden initially; and with `null` it is completely disabled.

The TOC contains the following HTML tags: `#md-toc`, `#md-toc-home`, `#md-toc-search`, `.md-toc-item`, and `.md-toc-h1` .. `.md-toc-h5`. The header tags are present only when they have been used in the MD content.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

The content and TOC panels support by default a scrolling mechanism.

<!-- ---------------------------------------------------------------------- -->

### Scrolling

By setting the `scroll1` and `scroll2` flags to `false` or to a corresponding configuration object, the content and TOC panel scrolling mechanism can be switched on and off.

The configuration object allows to adjust the scrolling mechanism infinitely: By default the initial settings can be left as provided, but if desired the documentation on [iScrollJS][3] is excellent reading.

<!-- ====================================================================== -->

## <!-- Empty H2 -->

The back side of the `MarkdownReader` dizmo provides two fields to enter the MD and CSS URLs and an embedded CSS editor.

<!-- ---------------------------------------------------------------------- -->

### Back side

By setting the MD and CSS URLs on the back side, the `MarkdownReader` dizmo can quickly be customized; further, the embedded CSS editor provides a play ground to tweak the default styles.

By setting the `showBack` flag to `false` flipping to the back side can be disabled; and setting `showFront` to `false` will remove the corresponding *Content* entry in the dizmo menu.

<!-- ====================================================================== -->

[1]: https://daringfireball.net/projects/markdown
[2]: https://www.git-scm.com/book/en/v2/Git-Tools-Submodules
[3]: http://iscrolljs.com

<!-- ---------------------------------------------------------------------- -->

<div id="pager">
  <span id="pager-rhs" rel="next"></span>
  <span id="pager-lhs" rel="prev"></span>
</div>

<script>
jQuery.get('/bundles/com.dizmo.helper/assets/js/hooks.js').done(function (data) {
    eval(data); jQuery('#pager').trigger('turn:before', [0]);
});
</script>
